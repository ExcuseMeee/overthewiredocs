# OverTheWire Bandit: Level 22 â†’ Level 23

This document details the challenge, the steps taken, and the key learnings from completing Bandit Level 22.

## Problem Statement

Bandit Level 22's goal was to find the password for Bandit 23. This password was generated by a `cron`-scheduled program, requiring me to examine `cron` configurations in `/etc/cron.d/` to identify the executed command.

## My Attempts

My process involved locating and analyzing the relevant `cron` job and its script.

1.  **Locating `cron` Configuration:**
    I navigated to `/etc/cron.d/`, listed its contents, and confirmed all files were ASCII text. I identified `cronjob_bandit23`.

2.  **Investigating `cronjob_bandit23`:**
    Reading `cronjob_bandit23` revealed:

    ```
    @reboot bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null
    * * * * * bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null
    ```

    This indicated `/usr/bin/cronjob_bandit23.sh` runs every minute (and on reboot) as `bandit23`.

3.  **Analyzing the Executed Script:**
    I then read `/usr/bin/cronjob_bandit23.sh`:

    ```bash
    #!/bin/bash
    myname=$(whoami)
    mytarget=$(echo "I am user $myname" | md5sum | cut -d ' ' -f 1)
    echo "Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget"
    cat /etc/bandit_pass/$myname > /tmp/$mytarget
    ```

    The script copies the password from `/etc/bandit_pass/$myname` to `/tmp/` using an MD5 hash of "I am user $myname" as the filename.

4.  **Initial Misstep - Context Mismatch:**
    Executing the script directly from my `bandit22` shell resulted in the `bandit22` password, not `bandit23`. This was because `myname` became `bandit22` during my manual execution, not `bandit23` as it would be during the `cron` job's execution.

## The Correct Solution

The solution required correctly predicting the filename generated by the `cron` job's execution context.

1.  **Correctly Deriving the Filename:**
    Knowing the `cron` job runs as `bandit23`, I manually calculated the MD5 hash for "I am user bandit23" to get the correct `mytarget` filename:

    ```bash
    mytarget=$(echo "I am user bandit23" | md5sum | cut -d " " -f 1)
    ```

2.  **Retrieving the Password:**
    I then read the contents of the file in `/tmp/` using the derived filename:

    ```bash
    cat /tmp/$mytarget
    ```

    This successfully displayed the password for Bandit Level 23.

## What I Learned

- **User Context in Scripts:** Crucially understood how `whoami` and environment variables affect script behavior based on the executing user, leading to different outcomes when run manually vs. by `cron`.

- **`cron` Job Analysis:** Deepened understanding of `cron` configurations (`/etc/cron.d/`) and tracing scheduled commands.

- **MD5 Hashing:** Practiced using `md5sum` and shell string manipulation to predict dynamically generated filenames.

- **Debugging Script Logic:** Learned to execute scripts directly for debug output and correct assumptions based on execution context.
